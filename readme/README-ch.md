# 光在小孔中的菲涅尔反射与能量吸收模拟软件

基于菲涅尔方程的计算物理仿真平台，专门研究飞秒激光刻蚀硅材料过程中的角度相关光吸收现象。

![演示图](./demo.png)

## 物理原理

在飞秒激光刻蚀硅材料的实验中，有一个现象是：孔洞密度较高的区域，其刻蚀效率明显超过孔洞稀疏的区域。这一现象的根源在于凹坑结构产生的激光多重反射增强效应。

腔体轮廓采用**高斯表面函数**建模：

```
y(x) = A · exp(-((x - μ)² / (2σ²)))
```

其中 `A` 表示由几何约束确定的振幅系数：

```
A = (hole_radius × depth_ratio × σ × √(2π)) / (σ × √(2π))
```

在微观凹坑内部，激光束的不同部分以各种角度撞击坑壁，形成了复杂的**入射角分布**。由于硅材料的光学特性具有明显的**角度依赖性**，不同入射角对应着不同的激光**吸收效率**。这种几何效应与材料特性的耦合，造就了非均匀的能量吸收分布。

本软件运用**菲涅尔方程**来精确计算这种角度相关的光学响应。对于s偏振光和p偏振光，其**反射系数**分别为：

**S偏振反射率：**
```
Rs = [(cos(θᵢ) - n·cos(θᵣ)) / (cos(θᵢ) + n·cos(θᵣ))]²
```

**P偏振反射率：**
```
Rp = [(cos(θᵣ) - n·cos(θᵢ)) / (cos(θᵣ) + n·cos(θᵢ))]²
```

**总反射率**和**吸收率**由以下公式给出：
```
R = (Rs + Rp) / 2
A = 1 - R
```

式中 `θᵢ` 为入射角，`θᵣ` 为折射角（遵循**斯涅尔定律**），`n` 为硅材料的**复折射率**（本仿真中取值 n = 4.2231 + i·0.061005）。

### 光线追踪算法

软件采用了精巧的**几何光学追踪法**来计算弯曲表面上的反射过程：

1. **表面法线计算**：对于高斯腔体表面上的每个碰撞点，使用腔体轮廓的导数计算局部**表面法线**：
   ```
   dx/dy = dA/dt · exp(-((t - μ)² / (2σ²))) · (-(t - μ)/σ²)
   ```
   
   **切线斜率**(dy/dx)和**法线斜率**推导为：
   ```
   tangent_slope = 1 / (dx/dy)
   normal_slope = -1 / tangent_slope
   ```

2. **入射角确定**：相对于表面法线的**相对入射角**计算为：
   ```
   θᵢ_rel = arctan(incident_slope) - arctan(normal_slope)
   ```

3. **镜面反射定律**：遵循**反射定律**，**相对反射角**等于负入射角：
   ```
   θᵣ_rel = -θᵢ_rel
   ```

4. **绝对反射方向**：全局坐标系中的**绝对反射角**为：
   ```
   θᵣ_abs = arctan(normal_slope) + θᵣ_rel
   reflection_slope = tan(θᵣ_abs)
   ```

5. **光线-表面交点**：下一个碰撞点通过求解**超越方程**确定：
   ```
   center_y + t - (k·(center_x + A·exp(-((t-μ)²/(2σ²)))) + b) = 0
   ```
   使用**牛顿-拉夫逊迭代法**和多个初始猜测来确保收敛。

该仿真包含：

- 硅在特定波长下的**复折射率**(n + ik)
- **入射角依赖反射率**和**透射系数**
- 圆柱腔体几何内的**多重反射级联**
- **能量沉积分布**和**吸收增强因子**

## Features

### 灵活的参数调节
- **激光参数设置**：
  - 可调节激光束半径（支持高斯光束建模）
  - 自由设定激光入射位置坐标
  - 自动计算入射角度分布
  
- **微孔几何参数**：
  - 可控制微孔半径大小
  - 调节深宽比（孔深与孔径的比值）
  - 考虑表面粗糙度对反射的影响

- **材料光学参数**：
  - 支持复折射率设定（实部 + 虚部）
  - **实部n值**：影响光的折射和传播速度
  - **虚部k值**：决定材料的光吸收能力
  - 针对硅材料的光学常数标定

### 直观的可视化界面
- **实时光路显示**：动态展现激光的入射、反射和透射轨迹
- **便捷的操作体验**：支持鼠标缩放、平移查看细节
- **能量分布图**：用颜色直观显示局部能量密度和吸收热区
- **数据统计面板**：实时计算并显示总吸收率、反射系数等关键指标

## Quick Start

### 运行环境
- **Python**：需要3.8或更高版本

### 安装步骤

1. **获取源码**
   
2. **创建虚拟环境**

3. **安装依赖包**
   ```bash
   pip install -r requirements.txt
   ```

4. **启动程序**
   ```bash
   python run.py
   ```